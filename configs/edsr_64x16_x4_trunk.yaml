model:
  scale: 4
  n_feats: 64
  n_resblocks: 16
  res_scale: 0.1

training:
  steps: 200000
  batch_size: 40
  val_every: 1000
  amp: true
  compile: true
  tail_only: false
  warmup_steps: 0
  warmup_start_factor: 0.001
  early_stop_patience: 40
  early_stop_min_delta: 0.005

optimizer:
  type: adam
  lr_tail: 0.000020
  lr_trunk: 0.000050
  weight_decay: 0.000000

loss:
  charbonnier_weight: 1.0
  charbonnier_eps: 0.001
  l1_weight: 0.1
  grad_weight: 0.05
  lpips_weight: 0.0
  lpips_net: alex

degradations:
  nearest_prob: 0.45
  box_prob: 0.25
  bilinear_prob: 0.30
  tiny_blur_prob: 0.25
  jpeg_prob: 0.50
  jpeg_quality_min: 60
  jpeg_quality_max: 95
  palette_jitter_prob: 0.60
  palette_jitter_std: 0.04
  channel_drop_prob: 0.10
  gaussian_noise_prob: 0.50
  gaussian_noise_std: 0.01

data:
  root: data
  auto_split_seed: 42
  auto_split_ratio: { train: 0.8, val: 0.1, test: 0.1 }
  patch_size_hr: 128
  patch_schedule:
    - { step: 0, size: 64 }
    - { step: 60000, size: 96 }
    - { step: 120000, size: 128 }
  val_patch_size_hr: null
  crops_tile_aligned_prob: 0.6
  flips: true
  rotations: true
  val_batch_size: 1
  train_workers: 12
  val_workers: 4
  prefetch_factor: 6
  val_prefetch_factor: 2
  persistent_workers: true
  val_persistent_workers: true

pretrained_path: runs/edsr_x4/best.pth
output_dir: runs/edsr_x4_trunk
seed: 42
